(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{258:function(_,v,t){"use strict";t.r(v);var a=t(6),l=Object(a.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h1",{attrs:{id:"infinite-project"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#infinite-project"}},[_._v("#")]),_._v(" infinite-project")]),_._v(" "),v("h2",{attrs:{id:"lightning"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#lightning"}},[_._v("#")]),_._v(" lightning")]),_._v(" "),v("h3",{attrs:{id:"_1-编辑页的设计-组件的设计-单向数据流"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-编辑页的设计-组件的设计-单向数据流"}},[_._v("#")]),_._v(" 1. 编辑页的设计，组件的设计，单向数据流？")]),_._v(" "),v("h3",{attrs:{id:"_2-jssdk-事件上报-错误监控-行为回溯"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-jssdk-事件上报-错误监控-行为回溯"}},[_._v("#")]),_._v(" 2. jssdk：事件上报 / 错误监控 / 行为回溯")]),_._v(" "),v("ul",[v("li",[_._v("错误监控\n"),v("ul",[v("li",[_._v("脚本执行报错\n"),v("ul",[v("li",[_._v("报错信息")]),_._v(" "),v("li",[_._v("报错次数")]),_._v(" "),v("li",[_._v("设备类型(android / ios)")])])]),_._v(" "),v("li",[_._v("资源加载报错\n"),v("ul",[v("li",[_._v("资源的地址")]),_._v(" "),v("li",[_._v("资源的类型")]),_._v(" "),v("li",[_._v("报错次数")])])]),_._v(" "),v("li",[_._v("接口请求报错\n"),v("ul",[v("li",[_._v("接口地址")]),_._v(" "),v("li",[_._v("页面加载速度")])])])])]),_._v(" "),v("li",[_._v("事件上报\n"),v("ul",[v("li",[_._v("活动页关键节点埋点（"),v("code",[_._v("定义一套固定的事件列表，每个组件通过可视化选择上报事件")]),_._v("）")]),_._v(" "),v("li",[_._v("桑基图回溯")])])]),_._v(" "),v("li",[_._v("行为回溯\n"),v("ul",[v("li",[_._v("录屏")])])])]),_._v(" "),v("h3",{attrs:{id:"_3-权限设计"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-权限设计"}},[_._v("#")]),_._v(" 3. 权限设计")]),_._v(" "),v("ul",[v("li",[_._v("登录权限(单点登录)")]),_._v(" "),v("li",[_._v("页面权限(路由控制)\n"),v("ul",[v("li",[_._v("后端数据库存对应用户的路由权限，然后在全局的路由守卫中对页面进行过滤")])])]),_._v(" "),v("li",[_._v("功能权限("),v("code",[_._v("自定义指令 v-auth")]),_._v(")")])]),_._v(" "),v("h3",{attrs:{id:"_4-husky-配置git-提供的提交时生命周期-限制提交的分支-文件夹"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-husky-配置git-提供的提交时生命周期-限制提交的分支-文件夹"}},[_._v("#")]),_._v(" 4. husky（配置git 提供的提交时生命周期，限制提交的"),v("code",[_._v("分支")]),_._v("/"),v("code",[_._v("文件夹")]),_._v("）")]),_._v(" "),v("ul",[v("li",[v("code",[_._v("husky")]),_._v(" - "),v("code",[_._v("hooks")]),_._v(" "),v("ul",[v("li",[_._v("post-checkout")]),_._v(" "),v("li",[_._v("pre-commit")]),_._v(" "),v("li",[_._v("commit-msg")])])]),_._v(" "),v("li",[_._v("child_process - "),v("code",[_._v("spawn")]),_._v("：命令行执行库")]),_._v(" "),v("li",[_._v("chalk：输出带颜色的log")]),_._v(" "),v("li",[_._v("process：进程控制")])]),_._v(" "),v("h3",{attrs:{id:"_5-脚本-建议单独写个小项目作为开发cli工具-涉及vue-的工作原理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-脚本-建议单独写个小项目作为开发cli工具-涉及vue-的工作原理"}},[_._v("#")]),_._v(" 5. 脚本（"),v("strong",[_._v("建议单独写个小项目作为开发cli工具,涉及vue 的工作原理")]),_._v("）")]),_._v(" "),v("ul",[v("li",[_._v("打包模板 yarn template")]),_._v(" "),v("li",[_._v("启动模板 yarn serve")]),_._v(" "),v("li",[_._v("打包项目 yarn build")])]),_._v(" "),v("h3",{attrs:{id:"_6-性能优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-性能优化"}},[_._v("#")]),_._v(" 6. 性能优化")]),_._v(" "),v("ul",[v("li",[v("strong",[v("code",[_._v("性能优化常见手段")])])]),_._v(" "),v("li",[v("strong",[v("code",[_._v("首屏优化： 关键渲染路径")])]),_._v(" "),v("ul",[v("li",[_._v("懒加载，预加载，代码压缩gzip")]),_._v(" "),v("li",[_._v("性能优化指标（FP,FCP,LCP）")])])])]),_._v(" "),v("h3",{attrs:{id:"_7-打包资源上传-cdn-webpack-插件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_7-打包资源上传-cdn-webpack-插件"}},[_._v("#")]),_._v(" 7. 打包资源上传 cdn webpack 插件")]),_._v(" "),v("h3",{attrs:{id:"项目总结"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#项目总结"}},[_._v("#")]),_._v(" 项目总结")]),_._v(" "),v("h4",{attrs:{id:"难点-亮点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#难点-亮点"}},[_._v("#")]),_._v(" 难点/亮点")]),_._v(" "),v("blockquote",[v("ol",[v("li",[v("strong",[_._v("组件开发设计、组件数据处理（数据流问题）")])])])]),_._v(" "),v("ul",[v("li",[_._v("组件的分类\n"),v("ul",[v("li",[_._v("全局组件")]),_._v(" "),v("li",[_._v("业务组件\n"),v("ul",[v("li",[_._v("主体展示")]),_._v(" "),v("li",[_._v("配置编辑器")]),_._v(" "),v("li",[_._v("样式编辑器")])])]),_._v(" "),v("li",[_._v("样式组件")])])])]),_._v(" "),v("blockquote",[v("ol",{attrs:{start:"2"}},[v("li",[v("strong",[_._v("模板配置的变化追踪")])])])]),_._v(" "),v("ul",[v("li",[_._v("对象的变化\n"),v("ul",[v("li",[_._v("增")]),_._v(" "),v("li",[_._v("删")]),_._v(" "),v("li",[_._v("改")])])]),_._v(" "),v("li",[_._v("数组的变化\n"),v("ul",[v("li",[_._v("数组长度变化")]),_._v(" "),v("li",[_._v("数组增删")])])])]),_._v(" "),v("blockquote",[v("ol",{attrs:{start:"3"}},[v("li",[v("strong",[_._v("一次性能优化")])])])]),_._v(" "),v("ul",[v("li",[_._v("优化 pdf和弹层组件（体积大大缩小）\n"),v("ul",[v("li",[_._v("pdf（展示的时候才进行转化和渲染）")]),_._v(" "),v("li",[_._v("弹层组件（按需加载）")])])])]),_._v(" "),v("h4",{attrs:{id:"待优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#待优化"}},[_._v("#")]),_._v(" 待优化")]),_._v(" "),v("h4",{attrs:{id:"设计思路"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#设计思路"}},[_._v("#")]),_._v(" 设计思路")]),_._v(" "),v("h4",{attrs:{id:"运作流程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#运作流程"}},[_._v("#")]),_._v(" 运作流程")]),_._v(" "),v("h4",{attrs:{id:"相关问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#相关问题"}},[_._v("#")]),_._v(" 相关问题")]),_._v(" "),v("blockquote",[v("p",[_._v("当时为什么 sdk 不用开源的项目，要自己搞一个？")])]),_._v(" "),v("h2",{attrs:{id:"desktop-micro"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#desktop-micro"}},[_._v("#")]),_._v(" desktop-micro")]),_._v(" "),v("h3",{attrs:{id:"_1-monorepo"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-monorepo"}},[_._v("#")]),_._v(" 1. Monorepo")]),_._v(" "),v("ul",[v("li",[v("p",[_._v("优点")]),_._v(" "),v("ul",[v("li",[_._v("易于代码复用：所有项目代码集中于单一仓库，易于抽离出共用的业务组件或工具")]),_._v(" "),v("li",[_._v("易于依赖管理：依赖版本统一管理")])])]),_._v(" "),v("li",[v("p",[_._v("yarn + workspace")]),_._v(" "),v("ul",[v("li",[_._v("避免重复安装包，减少了磁盘空间的占用，并降低了构建时间；")]),_._v(" "),v("li",[_._v("内部代码可以彼此相互引用")])])]),_._v(" "),v("li",[v("p",[_._v("配置")]),_._v(" "),v("ul",[v("li",[_._v("根目录 package.json\n"),v("ul",[v("li",[v("code",[_._v("workspaces")]),_._v(" 字段，定义哪个目录下为子项目")]),_._v(" "),v("li",[v("code",[_._v("private => true")]),_._v("，防止误将仓库发布")])])]),_._v(" "),v("li",[_._v(".eslintrc / .stylelintrc 等配置文件 下通过,根目录配置全局的一套方案，子应用通过 "),v("code",[_._v("extends")]),_._v(" 字段获取父应用的相关配置")])])])]),_._v(" "),v("h3",{attrs:{id:"_2-复杂的权限设计"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-复杂的权限设计"}},[_._v("#")]),_._v(" 2. 复杂的权限设计")]),_._v(" "),v("p",[_._v("（主应用控制，进入主应用后，获取用户角色和权限列表和数据列表，过滤路由列表只渲染特定的页面和限制接口数据）")]),_._v(" "),v("ul",[v("li",[_._v("应用权限\n"),v("ul",[v("li",[_._v("逻辑定义上：角色的权限是固定的，由系统管理员规定，每个角色拥有不同的"),v("code",[_._v("应用权限")]),_._v("，如果某用户想拥有多个功能，则分配多个权限")]),_._v(" "),v("li",[_._v("实现上：每个路由菜单和功能按钮会有 "),v("code",[_._v("路径path")]),_._v(" 和 "),v("code",[_._v("唯一标识code")]),_._v("，统一成一个数组传到后端，这就决定了这个用户应用权限\n"),v("ul",[v("li",[_._v("其中"),v("code",[_._v("路由菜单")]),_._v("通过 "),v("code",[_._v("beforeRouterEnter")]),_._v(" 钩子过滤")]),_._v(" "),v("li",[v("code",[_._v("功能按钮")]),_._v("通过"),v("code",[_._v("自定义指令")]),_._v("实现")])])])])]),_._v(" "),v("li",[_._v("数据权限\n"),v("ul",[v("li",[_._v("数据权限是根这用户走的，每个用户的数据权限不一致，决定了该用户在同一模块下可见的数据（一般都是按自己的项目走)")])])])]),_._v(" "),v("h3",{attrs:{id:"项目总结-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#项目总结-2"}},[_._v("#")]),_._v(" 项目总结")]),_._v(" "),v("h4",{attrs:{id:"项目难点、亮点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#项目难点、亮点"}},[_._v("#")]),_._v(" 项目难点、亮点")]),_._v(" "),v("blockquote",[v("ol",[v("li",[_._v("基础建设上（组件的二次封装）")])])]),_._v(" "),v("ul",[v("li",[_._v("table 组件（保证通用性前提下的简易性设计，"),v("code",[_._v("个性化和通用性")]),_._v(" 两者的权衡）\n"),v("ul",[v("li",[_._v("props: fields（搜索） / columns（表格列） / toolbar（拓展操作） / paging（分页） / api（数据获取）")]),_._v(" "),v("li",[_._v("event: "),v("code",[_._v("列排序")]),_._v(" / "),v("code",[_._v("展开行")]),_._v(" / "),v("code",[_._v("展开行二次排序")])])])]),_._v(" "),v("li",[_._v("搜索条件组件\n"),v("ul",[v("li",[_._v("类型多样：下拉(单选/多选/分组) / 输入 / 日期 / 城市选择")]),_._v(" "),v("li",[_._v("数据预加载：把该用户下有权数据渲染到对应的组件选项中")]),_._v(" "),v("li",[_._v("通讯：组件和表单组件的结合，怎么通讯更合适")])])])]),_._v(" "),v("blockquote",[v("ol",{attrs:{start:"2"}},[v("li",[_._v("业务上")])])]),_._v(" "),v("ul",[v("li",[_._v("复杂度高（融合了公司核心业务后台，推到8年+的产品）")]),_._v(" "),v("li",[_._v("数据量大（百万级别）")]),_._v(" "),v("li",[_._v("功能性强（展开列/二次排序/自定义列/高级搜索等）\n"),v("ul",[v("li",[v("p",[v("strong",[_._v("高级搜索，动态渲染搜索表单")])]),_._v(" "),v("ul",[v("li",[_._v("描述：活动默认可搜索的字段是固定的，需要具体搜索某个字段数据的时候需要使用到")]),_._v(" "),v("li",[_._v("难点\n"),v("ul",[v("li",[_._v("渲染方面（"),v("code",[_._v("动态渲染搜索表单")]),_._v("）\n"),v("ol",[v("li",[_._v("每个项目的字段是不同的，导致"),v("code",[_._v("可搜索的字段需要动态配置")]),_._v("（全放出来太多了，有100多个字段）")]),_._v(" "),v("li",[_._v("后端存储当前项目搜索字段的配置，后端返回后，前端要"),v("code",[_._v("动态渲染搜索表单")])]),_._v(" "),v("li",[_._v("如果字段是统一类型还好，但字段分为"),v("code",[_._v("6种类型(文本框、时间范围、城市选择、下拉框、值范围)")]),_._v("，不同类型要渲染不同组件（尤其时间范围和城市选择）")])])]),_._v(" "),v("li",[_._v("传值方面（"),v("code",[_._v("数据处理")]),_._v("）\n"),v("ol",[v("li",[_._v("用户在不同类型表单组件输入值后，前端需要将值根据不同的表单类型按照不同处理方式，然后拼接上字段类型传给后端")])])])])])])]),_._v(" "),v("li",[v("p",[v("strong",[_._v("自定义列，动态渲染表格列")])]),_._v(" "),v("ul",[v("li",[_._v("描述：表格会有默认的所有项目都存在的列字段，用户可以自定义要展示的列")]),_._v(" "),v("li",[_._v("难点\n"),v("ol",[v("li",[_._v("字段不固定：列字段是后端返回的，不是固定的数据字典（不同项目活动字段不同）")]),_._v(" "),v("li",[_._v("字段渲染：配置好要展示的列后，列要怎么渲染是个头疼的问题")])]),_._v(" "),v("ul",[v("li",[_._v("将常规字段按照字段类型定义了内容渲染规则")]),_._v(" "),v("li",[_._v("对所有特殊字段写了一份渲染规则")])]),_._v(" "),v("ol",{attrs:{start:"3"}},[v("li",[_._v("字段排序？存储？")])]),_._v(" "),v("ul",[v("li",[_._v("通过 sortable拖拽排序")]),_._v(" "),v("li",[_._v("存储在 localstorage")])]),_._v(" "),v("ol",{attrs:{start:"4"}},[v("li",[_._v("列宽问题(渲染内容过长，不美观)")])]),_._v(" "),v("ul",[v("li",[_._v("处理完列数据后，在重新渲染表格的时候，遍历表格内容，获取字段列中最长的内容（根据中英文和数字分别计算长度，进而控制列宽）")])])])])])])])]),_._v(" "),v("h4",{attrs:{id:"待优化-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#待优化-2"}},[_._v("#")]),_._v(" 待优化")]),_._v(" "),v("h4",{attrs:{id:"设计思路-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#设计思路-2"}},[_._v("#")]),_._v(" 设计思路")]),_._v(" "),v("h4",{attrs:{id:"运作流程-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#运作流程-2"}},[_._v("#")]),_._v(" 运作流程")]),_._v(" "),v("h4",{attrs:{id:"相关问题-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#相关问题-2"}},[_._v("#")]),_._v(" 相关问题")]),_._v(" "),v("blockquote",[v("p",[_._v("Q1：Why not Iframe？\n"),v("a",{attrs:{href:"https://www.yuque.com/kuitos/gky7yw/gesexv",target:"_blank",rel:"noopener noreferrer"}},[_._v("Why Not Iframe？"),v("OutboundLink")],1)])]),_._v(" "),v("blockquote",[v("p",[_._v("Q2：复杂的权限设计？")])]),_._v(" "),v("p",[_._v("分两大模块")]),_._v(" "),v("ul",[v("li",[_._v("应用权限")]),_._v(" "),v("li",[_._v("数据权限（贯穿所有应用，以企业为维度，不同的项目运营同学只看自己项目的数据）")])]),_._v(" "),v("p",[_._v("用户的权限取决于角色的权限，角色的权限由树状结构存储(path,code,level)")]),_._v(" "),v("p",[_._v("路由由主应用控制，当请求获取到对应用户的权限后，动态渲染菜单")]),_._v(" "),v("blockquote",[v("p",[_._v("Q3：讲一下为什么用微前端，qiankun的特性是什么，和其他微前端框架对比？")])]),_._v(" "),v("p",[v("strong",[_._v("微前端架构")])]),_._v(" "),v("ul",[v("li",[_._v("HTML entry")]),_._v(" "),v("li",[_._v("沙箱\n"),v("ul",[v("li",[_._v("js 沙箱隔离")]),_._v(" "),v("li",[_._v("css 样式隔离")])])]),_._v(" "),v("li",[_._v("应用间通信")]),_._v(" "),v("li",[_._v("预加载")])]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("微前端框架")]),_._v(" "),v("th",[_._v("原理")]),_._v(" "),v("th",[_._v("优点")]),_._v(" "),v("th",[_._v("不足")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("qiankun(ali基于single-spa)")]),_._v(" "),v("td",[_._v("监听路由变化，渲染对应的子应用，进行挂载")]),_._v(" "),v("td",[_._v("1.单一子应用   2.子应用无法保活  3.接入适配成本高")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("wujie(tencent)")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("micro-app(jd)")]),_._v(" "),v("td",[v("strong",[_._v("WebComponent")]),_._v("、CustomElement、ShadowDom")]),_._v(" "),v("td"),_._v(" "),v("td")])])]),_._v(" "),v("p",[_._v("拓展："),v("a",{attrs:{href:"https://eluxjs.com/designed/micro-module.html",target:"_blank",rel:"noopener noreferrer"}},[v("strong",[_._v("微模块")]),v("OutboundLink")],1)]),_._v(" "),v("blockquote",[v("p",[_._v("Q4: why? 背景? 优缺点?")])]),_._v(" "),v("ul",[v("li",[_._v("业务上：为了整合公司已有的众多后台管理系统，删减遗弃的系统功能，也为了梳理业务线条，统一化系统管理")]),_._v(" "),v("li",[_._v("技术上：为了后续新系统接入，兼容不同技术的系统，同时接触全新的 ts+vue3 技术体系")])]),_._v(" "),v("blockquote",[v("p",[_._v("Q5: 说说你对monorepo的理解？他的优缺点是什么？")])]),_._v(" "),v("p",[_._v("A：传统的"),v("code",[_._v("mutirepo")]),_._v("是多项目多仓库，而"),v("code",[_._v("monorepo")]),_._v("是多项目单仓库，目前google,vue3,vite 这些知名开源项目都是采用这种方式进行管理。")]),_._v(" "),v("ul",[v("li",[_._v("mutirepo的痛点\n"),v("ul",[v("li",[_._v("代码复用：不利于 组件/工具函数/配置 的复用")]),_._v(" "),v("li",[_._v("版本管理：同一个依赖，不同项目可能用了不同版本，每个项目都需要手动依次更新")]),_._v(" "),v("li",[_._v("项目基建：CICD流程，发布部署，代码提交流程的不统一")])])])]),_._v(" "),v("h2",{attrs:{id:"eams、uni-app、小蓝书、官网"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#eams、uni-app、小蓝书、官网"}},[_._v("#")]),_._v(" eams、uni-app、小蓝书、官网")]),_._v(" "),v("p",[v("code",[_._v("Vue3 + Ts + Vite + Pinia + echarts + Tailwindcss")])]),_._v(" "),v("h3",{attrs:{id:"_1-制定代码和git规范-standard-规范-、自动化版本管理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-制定代码和git规范-standard-规范-、自动化版本管理"}},[_._v("#")]),_._v(" 1. 制定代码和git规范("),v("code",[_._v("standard")]),_._v(" 规范)、自动化版本管理")]),_._v(" "),v("ul",[v("li",[v("p",[_._v("git cz => Commitlint规范化提交格式 / cz-conventional-changelog(changelog生成)")])]),_._v(" "),v("li",[v("p",[_._v("standard-version => 根据提交信息，更新版本号，打tag")])]),_._v(" "),v("li",[v("p",[_._v("代码规范(eslint检测 + vscode 插件自动格式化)")]),_._v(" "),v("ul",[v("li",[_._v("js: "),v("code",[_._v("Eslint")])]),_._v(" "),v("li",[_._v("html: "),v("code",[_._v("plugin:vue/vue3-essential")]),_._v("/"),v("code",[_._v("plugin:vue/recommended")]),_._v("、"),v("code",[_._v("@vue/standard")])]),_._v(" "),v("li",[_._v("ts: "),v("code",[_._v("@vue/typescript/recommended")])]),_._v(" "),v("li",[_._v("scss: stylelint "),v("code",[_._v("stylelint-config-standard-scss")])])])]),_._v(" "),v("li",[v("p",[_._v("git规范：格式化提交，自动化更新版本号及生成changelog")]),_._v(" "),v("ul",[v("li",[_._v("Husky(pre-commit/commit-msg/pre-push) + Lint-staged")]),_._v(" "),v("li",[_._v("Commitlint(git cz) + cz-conventional-changelog")]),_._v(" "),v("li",[_._v("standard-version：更新版本")])])])]),_._v(" "),v("h3",{attrs:{id:"_2-echarts封装"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-echarts封装"}},[_._v("#")]),_._v(" 2. "),v("strong",[_._v("echarts封装")])]),_._v(" "),v("h3",{attrs:{id:"_3-pinia-持久化存储-pinia-plugin-persistedstate"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-pinia-持久化存储-pinia-plugin-persistedstate"}},[_._v("#")]),_._v(" 3. pinia + 持久化存储("),v("code",[_._v("pinia-plugin-persistedstate")]),_._v(")")]),_._v(" "),v("h3",{attrs:{id:"_4-首屏加载优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-首屏加载优化"}},[_._v("#")]),_._v(" 4. 首屏加载优化")]),_._v(" "),v("ul",[v("li",[_._v("ngnix 开启gzip压缩")]),_._v(" "),v("li",[_._v("前端 "),v("code",[_._v("compression-webpack-plugin")]),_._v(" 插件压缩js和css")])]),_._v(" "),v("h3",{attrs:{id:"_5-html2canvas-pdfjs"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-html2canvas-pdfjs"}},[_._v("#")]),_._v(" 5. html2canvas pdfjs")]),_._v(" "),v("ul",[v("li",[_._v("图片如何适配pdf大小")]),_._v(" "),v("li",[v("strong",[_._v("页眉页码")])]),_._v(" "),v("li",[_._v("清晰度问题：设置缩放比例，设置设备像素比")]),_._v(" "),v("li",[v("strong",[_._v("！！分页处理")]),_._v(" "),v("ul",[v("li",[_._v("先将长图统一转成canvas")]),_._v(" "),v("li",[_._v("然后通过固定的A4纸宽高（减去页眉页码），"),v("code",[_._v("新创建一个canvas")]),_._v("，用于"),v("code",[_._v("绘制当前页面的canvas")])]),_._v(" "),v("li",[_._v("通过宽高和原始的canvas数据，对新创建的canvas进行数据填充")]),_._v(" "),v("li",[_._v("一页页绘制")])])]),_._v(" "),v("li",[v("strong",[_._v("！！！截断处理")]),_._v(" "),v("ul",[v("li",[_._v("获取长图的dom，在绘制当页canvas时，判断当前最后一个元素高度是否被截断，截断则将此元素放至下一页")])])]),_._v(" "),v("li",[v("strong",[_._v("浏览器会限制最大的canvas高度(chrome: 16384px)")])])]),_._v(" "),v("h3",{attrs:{id:"_6-多请求下loading-的展示和关闭"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-多请求下loading-的展示和关闭"}},[_._v("#")]),_._v(" 6. 多请求下loading 的展示和关闭")]),_._v(" "),v("ul",[v("li",[_._v("通过全局的 app.vue 中全局的 loading配合 axios 拦截器实现（"),v("code",[_._v("axios 中需要增加一个请求计数器")]),_._v("=> 统计所有发出的请求数，每完成一个减一，当且仅当计数为0的时候才关闭loading）")])]),_._v(" "),v("h3",{attrs:{id:"_7-批量导出"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_7-批量导出"}},[_._v("#")]),_._v(" 7. 批量导出")]),_._v(" "),v("ul",[v("li",[_._v("服务端导出实现逻辑\n"),v("ol",[v("li",[_._v("客户端导入报表(excel)，node 接口读取关键字段")]),_._v(" "),v("li",[_._v("node 端通过 "),v("code",[_._v("puppeteer")]),_._v(" 创建浏览器，访问线上小蓝书页面，"),v("code",[_._v("通过点击事件触发导出")]),_._v("。")]),_._v(" "),v("li",[_._v("客户端配合将pdf上传至 "),v("code",[_._v("oss")]),_._v(" 服务器，生成线上链接，插入到页面中的节点属性中。")]),_._v(" "),v("li",[_._v("node 通过获取浏览器节点的属性，得到pdf链接")])])]),_._v(" "),v("li",[_._v("批量\n"),v("ul",[v("li",[_._v("promise 实现任务队列，控制并发数")])])])]),_._v(" "),v("h3",{attrs:{id:"项目总结-3"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#项目总结-3"}},[_._v("#")]),_._v(" 项目总结")]),_._v(" "),v("h4",{attrs:{id:"难点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#难点"}},[_._v("#")]),_._v(" 难点")]),_._v(" "),v("blockquote",[v("p",[_._v("pdfjs 导出 4、50页 的报告")])]),_._v(" "),v("ul",[v("li",[v("p",[_._v("中文字体")])]),_._v(" "),v("li",[v("p",[_._v("清晰度问题")])]),_._v(" "),v("li",[v("p",[_._v("可否复制问题")])]),_._v(" "),v("li",[v("p",[v("strong",[_._v("如何分页，何时截断")])]),_._v(" "),v("ul",[v("li",[v("p",[_._v("把 dom 细分到每个3级目录")])]),_._v(" "),v("li",[v("p",[_._v("图片打印分类")]),_._v(" "),v("ul",[v("li",[_._v("可复制的表（addTable 会自动换行）")]),_._v(" "),v("li",[_._v("不可绘制的表（用图片打印，判断最后一个td 进行截断）")]),_._v(" "),v("li",[_._v("echart 分类（直接打印，单页装不下就换行）")])])]),_._v(" "),v("li",[v("p",[_._v("打印方法")]),_._v(" "),v("ul",[v("li",[_._v("创建2个 canvas(1个装dom，另一个装截断的 dom)")])])])])])]),_._v(" "),v("h4",{attrs:{id:"可优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#可优化"}},[_._v("#")]),_._v(" 可优化")]),_._v(" "),v("h4",{attrs:{id:"设计思路-3"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#设计思路-3"}},[_._v("#")]),_._v(" 设计思路")]),_._v(" "),v("h4",{attrs:{id:"运作流程-3"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#运作流程-3"}},[_._v("#")]),_._v(" 运作流程")]),_._v(" "),v("h4",{attrs:{id:"项目背景"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#项目背景"}},[_._v("#")]),_._v(" 项目背景")])])}),[],!1,null,null,null);v.default=l.exports}}]);