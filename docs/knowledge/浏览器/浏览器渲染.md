# 浏览器渲染

## 相关知识点

- 回流重绘
- 关键渲染路径
- 性能优化


## 渲染过程

### 1. 构建 DOM 树



### 2. 构建 CSSOM 树

### 3. 合成渲染树

### 4. 布局

### 5. 绘制

### 6. 合并图层

### 7. 显示


## 注意事项

1. 最小化 DOM 操作和样式更改：DOM 操作和样式更改会触发浏览器的重排和重绘操作，因此应该尽量减少这些操作，尤其是在动画或滚动等高频操作中。

2. 使用 CSS3 动画或硬件加速：CSS3 动画可以通过 GPU 加速，提高动画的流畅度和性能。可以使用 transform、opacity、will-change 等属性来启用硬件加速。

3. 最小化网络请求和文件大小：减少文件大小和网络请求次数可以缩短页面加载时间，提高用户体验。

4. 避免使用阻塞渲染的 JavaScript：JavaScript 可能会阻塞渲染，导致页面加载缓慢。应该将 JavaScript 代码放在页面底部或使用 defer 或 async 属性来异步加载脚本。

5. 使用图片优化技术：图片占据了大量的网络带宽和页面空间，因此需要使用图片优化技术，如压缩、缓存、延迟加载、懒加载等方法来减少图片大小和数量。

6. 使用 CDN 加速：使用 CDN（内容分发网络）可以加速页面的加载速度，提高用户体验。CDN 可以缓存静态资源，分发到全球各地的服务器，减少网络延迟和带宽消耗。

7. 测试和监控：应该对页面进行测试和监控，了解页面性能、用户体验和错误信息，及时发现和解决问题，提高页面质量和性能。可以使用工具如 Lighthouse、WebPageTest、Chrome DevTools 等来测试和优化页面。



## 回流和重绘

### 回流

**触发条件**

简单来说，就是当我们对 DOM 结构的修改引发 DOM 几何尺寸变化的时候，会发生回流的过程。

  - DOM元素几何属性变化，常见如：width、height、padding、margin、left、top、border
  - DOM 节点 `增减` 或 `移动`
  - 读写 offset族、scroll族和client族属性
  - 调用 window.getComputedStyle 方法

**回流过程**

> 回流导致DOM树改变，需要浏览器重新生成和渲染DOM树，将渲染主线程流程都走一遍，开销巨大


### 重绘

**触发条件**

当 DOM 的修改导致了样式的变化，并且没有影响几何属性的时候，会导致重绘(repaint)。

**重绘过程**
